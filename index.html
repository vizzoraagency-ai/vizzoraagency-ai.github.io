<!doctype html>
<html lang="az">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>WhatsApp qrupuna qoşul</title>
<meta name="format-detection" content="telephone=no">
<style>
  :root { --green:#25D366; --text:#111; }
  html,body{margin:0;padding:0;background:#f6f7f8;color:var(--text);
    font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif}
  .wrap{min-height:100svh;display:grid;place-items:center;padding:24px}
  .card{max-width:640px;width:100%;background:#fff;border-radius:16px;
    box-shadow:0 6px 24px rgba(0,0,0,.06);padding:28px 24px;text-align:center}
  h1{margin:.2rem 0 1rem;font-size:clamp(22px,4.5vw,30px)}
  p{margin:.6rem 0 .9rem;line-height:1.6}
  .row{display:flex;gap:12px;flex-direction:column;align-items:center}
  .btn{display:inline-block;border:0;border-radius:12px;padding:14px 22px;
    font-weight:700;text-decoration:none;font-size:18px;width:100%;max-width:420px;cursor:pointer}
  .btn-primary{background:var(--green);color:#fff}
  .btn-outline{background:#eef3ee;color:#0b0b0b}
  .hint{font-size:14px;color:#666;margin-top:8px}
  .hidden{display:none}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>WhatsApp qrupuna qoşul</h1>
    <p id="intro">Aşağıdakı düymələrdən uyğun olanı seçin.</p>

    <!-- iOS: 3 düymə -->
    <div id="iosPanel" class="hidden">
      <div class="row">
        <a id="btnIOS_SAFARI" class="btn btn-primary"  href="#">Safari-də aç (tövsiyə)</a>
        <a id="btnIOS_WAB"    class="btn btn-outline" href="#">WhatsApp <b>Business</b> ilə aç</a>
        <a id="btnIOS_WA"     class="btn btn-outline" href="#">Adi WhatsApp ilə aç</a>
      </div>
      <p class="hint">Qeyd: TikTok/Instagram içindən gəlmisinizsə, əvvəlcə “Safari-də aç” düyməsinə basın.</p>
    </div>

    <!-- Android: 1 düymə (chooser/intent) -->
    <div id="androidPanel" class="hidden">
      <a id="btnAND" class="btn btn-primary" href="#">Qrupa qoşul (Android)</a>
      <p class="hint">Telefonunda hansı WhatsApp varsa (Adi/Business) onu seçəcəksən.</p>
    </div>

    <!-- Digər platformalar -->
    <div id="otherPanel" class="hidden">
      <a id="btnOTHER" class="btn btn-primary" href="#">Qrupa qoşul</a>
    </div>
  </div>
</div>

<script>
  /* ======= DƏVƏT KODUNU BURADA DƏYİŞDİR ======= */
  const CODE = "BNpKYIFxThjGWEYJV0EALR";

  /* ======= LINKLƏR ======= */
  const CHAT   = `https://chat.whatsapp.com/${CODE}`;              // universal link (tövsiyə iOS Safari)
  const ACCEPT = `https://wa.me/accept/${CODE}`;                    // alternativ qəbul linki
  const DL_WA  = `whatsapp://accept?code=${CODE}`;                  // Adi WhatsApp deep-link
  const DL_WAB = `whatsapp-business://accept?code=${CODE}`;         // Business deep-link

  /* ======= DETEKTORLAR ======= */
  const UA = navigator.userAgent || navigator.vendor || window.opera;
  const isAndroid = /Android/i.test(UA);
  const isIOS     = /iPhone|iPad|iPod/i.test(UA);

  // TikTok/IG in-app?
  function isInApp(){
    const l = UA.toLowerCase();
    return l.includes("tiktok") || l.includes("instagram") || l.includes("fbav") || l.includes("fb_iab");
  }

  function openNew(u){
    try{ window.open(u, "_blank", "noopener,noreferrer"); }
    catch(_){ location.href = u; }
  }

  /* ======= iOS PANELİ ======= */
  function setupIOS(){
    document.getElementById("iosPanel").classList.remove("hidden");

    // 1) Safari-də aç — universal link (ən stabil yol)
    document.getElementById("btnIOS_SAFARI").addEventListener("click", function(e){
      e.preventDefault();
      // in-app-dan çıxmaq üçün yeni tabda açırıq
      openNew(CHAT);
    });

    // 2) Business ilə aç — yalnız Safari içində işləyir
    document.getElementById("btnIOS_WAB").addEventListener("click", function(e){
      e.preventDefault();
      // əvvəlcə universal linki yeni tabda açıb Safari-yə keçməsinə kömək edirik
      if (isInApp()) openNew(CHAT);
      // 700 ms sonra deep-linkə cəhd (Safari-dəsinizsə “Aç” pəncərəsi çıxacaq)
      setTimeout(function(){ location.href = DL_WAB; }, 700);
      // sonda ehtiyat: qəbul səhifəsi
      setTimeout(function(){ location.href = ACCEPT; }, 1600);
    });

    // 3) Adi WhatsApp ilə aç — eyni məntiq
    document.getElementById("btnIOS_WA").addEventListener("click", function(e){
      e.preventDefault();
      if (isInApp()) openNew(CHAT);
      setTimeout(function(){ location.href = DL_WA; }, 700);
      setTimeout(function(){ location.href = ACCEPT; }, 1600);
    });
  }

  /* ======= ANDROID ======= */
  function setupAndroid(){
    document.getElementById("androidPanel").classList.remove("hidden");
    document.getElementById("btnAND").addEventListener("click", function(e){
      e.preventDefault();
      // chooser çıxsın deyə paket yazmırıq
      location.href = `intent://chat.whatsapp.com/${CODE}#Intent;scheme=https;end`;
      // ehtiyat keçidlər:
      setTimeout(()=>{ location.href = CHAT;   }, 800);
      setTimeout(()=>{ location.href = ACCEPT; }, 1600);
    });
  }

  /* ======= DİGƏR ======= */
  function setupOther(){
    document.getElementById("otherPanel").classList.remove("hidden");
    document.getElementById("btnOTHER").addEventListener("click", function(e){
      e.preventDefault();
      location.href = CHAT;
    });
  }

  /* ======= BAŞLAT ======= */
  (function init(){
    if (isIOS)         setupIOS();
    else if (isAndroid) setupAndroid();
    else               setupOther();
  })();
</script>
</body>
</html>
