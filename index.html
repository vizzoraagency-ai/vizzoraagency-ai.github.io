<!doctype html>
<html lang="az">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>WhatsApp qrupuna qoşul</title>
<meta name="format-detection" content="telephone=no">
<style>
  :root { --green:#25D366; --text:#111; }
  html,body{margin:0;padding:0;background:#f6f7f8;color:var(--text);
    font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif}
  .wrap{min-height:100svh;display:grid;place-items:center;padding:24px}
  .card{max-width:640px;width:100%;background:#fff;border-radius:16px;
    box-shadow:0 6px 24px rgba(0,0,0,.06);padding:28px 24px;text-align:center}
  h1{margin:.2rem 0 1rem;font-size:clamp(22px,4.5vw,30px)}
  p{margin:.6rem 0 .9rem;line-height:1.6}
  .row{display:flex;gap:12px;flex-direction:column;align-items:center}
  .btn{display:inline-block;border:0;border-radius:12px;padding:14px 22px;
    font-weight:700;text-decoration:none;font-size:18px;width:100%;max-width:420px;cursor:pointer}
  .btn-primary{background:var(--green);color:#fff}
  .btn-outline{background:#eef3ee;color:#0b0b0b}
  .hint{font-size:13px;color:#666;margin-top:8px}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>WhatsApp qrupuna qoşul</h1>
    <p>Aşağıdakı düymələrdən birini seç.</p>

    <div class="row">
      <a id="btnWAB" class="btn btn-primary"  href="#">WhatsApp <b>Business</b> ilə aç</a>
      <a id="btnWA"  class="btn btn-outline" href="#">Adi WhatsApp ilə aç</a>
    </div>
    <p class="hint">Android əvvəlki kimi işləyir; iOS-da yönləndirmələr eyni tabda ard-arda edilir.</p>
  </div>
</div>

<script>
  /* ==== DƏVƏT KODU ==== */
  const CODE = "BNpKYIFxThjGWEYJV0EALR";

  /* ==== Linklər ==== */
  const CHAT        = `https://chat.whatsapp.com/${CODE}`;      // universal qrup linki
  const ACCEPT_WA   = `https://wa.me/accept/${CODE}`;            // alternativ qəbul linki (stabil)
  const DL_WA       = `whatsapp://accept?code=${CODE}`;          // Adi WhatsApp deep-link (iOS)
  const DL_WAB      = `whatsapp-business://accept?code=${CODE}`; // Business deep-link (iOS)

  /* ==== Detektorlar ==== */
  const UA = navigator.userAgent || navigator.vendor || window.opera;
  const isAndroid = /Android/i.test(UA);
  const isIOS     = /iPhone|iPad|iPod/i.test(UA);

  /* ---------- ANDROID (dəyişmir – chooser) ---------- */
  function openAndroidWA(){
    location.href = `intent://chat.whatsapp.com/${CODE}#Intent;scheme=https;end`;
    setTimeout(()=>{ location.href = CHAT; }, 800);
  }
  function openAndroidWAB(){
    location.href = `intent://chat.whatsapp.com/${CODE}#Intent;scheme=https;end`;
    setTimeout(()=>{ location.href = CHAT; }, 800);
  }

  /* ---------- iOS: Eyni tabda ardıcıl yönləndirmələr ---------- */
  function openIOSWA(){
    // 1) universal link (webview-dan çıxmaq + dəvət)
    location.href = CHAT;
    // 2) qısa sonra adi WhatsApp deep-link (əgər adi WA həqiqətən istifadədədirsə, tutacaq)
    setTimeout(()=>{ location.href = DL_WA; }, 400);
    // 3) alınmasa stabil accept endpoint
    setTimeout(()=>{ if(!document.hidden) location.href = ACCEPT_WA; }, 1000);
    // 4) ən sonda yenə universal link
    setTimeout(()=>{ if(!document.hidden) location.href = CHAT; }, 1600);
  }

  function openIOSWAB(){
    // 1) birbaşa Business deep-link
    location.href = DL_WAB;
    // 2) alınmasa accept endpoint
    setTimeout(()=>{ if(!document.hidden) location.href = ACCEPT_WA; }, 700);
    // 3) sonra universal link
    setTimeout(()=>{ if(!document.hidden) location.href = CHAT; }, 1400);
    // 4) sonda yenə Business deep-link (artıq Safari-dəsə tutacaq)
    setTimeout(()=>{ if(!document.hidden) location.href = DL_WAB; }, 2000);
  }

  /* ---------- DESKTOP / DİGƏR ---------- */
  function openGeneric(){ location.href = CHAT; }

  /* ---------- DÜYMƏLƏR ---------- */
  const btnWAB = document.getElementById("btnWAB");
  const btnWA  = document.getElementById("btnWA");

  btnWAB.addEventListener("click", function(e){
    e.preventDefault();
    if (isAndroid) openAndroidWAB();
    else if (isIOS) openIOSWAB();
    else openGeneric();
  });

  btnWA.addEventListener("click", function(e){
    e.preventDefault();
    if (isAndroid) openAndroidWA();
    else if (isIOS) openIOSWA();
    else openGeneric();
  });
</script>
</body>
</html>
